<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>TensorFlow alapozó 7.</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">TensorFlow alapozó 7.</h1>
</header>
<section data-field="subtitle" class="p-summary">
TensorFlow.js, avagy neurális hálók futtatása és tanítása böngészőben és Node.js-en
</section>
<section data-field="body" class="e-content">
<section name="ea66" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="a0c5" id="a0c5" class="graf graf--h3 graf--leading graf--title">TensorFlow alapozó 7.</h3><h4 name="7f75" id="7f75" class="graf graf--h4 graf-after--h3 graf--subtitle">TensorFlow.js, avagy neurális hálók futtatása és tanítása böngészőben és Node.js-en</h4><figure name="644c" id="644c" class="graf graf--figure graf-after--h4"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 291px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 41.6%;"></div><img class="graf-image" data-image-id="1*YvKKzsjspxIfzY4Xj2e9pQ.png" data-width="1400" data-height="582" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*YvKKzsjspxIfzY4Xj2e9pQ.png"></div><figcaption class="imageCaption">Forrás: <a href="https://towardsdatascience.com/online-machine-learning-with-tensorflow-js-2ae232352901" data-href="https://towardsdatascience.com/online-machine-learning-with-tensorflow-js-2ae232352901" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">https://towardsdatascience.com/online-machine-learning-with-tensorflow-js-2ae232352901</a></figcaption></figure><p name="06e6" id="06e6" class="graf graf--p graf-after--figure">A <a href="https://www.tensorflow.org/js" data-href="https://www.tensorflow.org/js" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">TensorFlow.js</a> a <a href="https://www.tensorflow.org/" data-href="https://www.tensorflow.org/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">TensorFlow</a> JavaScript portja aminek segítségével böngészőben, vagy Node.js-en futtathatjuk és taníthatjuk a neurális hálóinkat. Habár a lehetőségek jóval korlátozottabbak mint a Python implementáció esetén, sok esetben jól jöhet a JavaScript megvalósítás. Ilyen lehet az, ha egy meglévő Node.js backendbe szeretnénk neurális hálókat csempészni vagy kliens oldalon futtatni egy objektum felismerő rendszert vagy bármi hasonlót. A teljesítményre sem lehet igazán panasz, hiszen a böngészős megvalósítás WebGL-t használ a GPU elérésére, a Node.js implementáció alatt pedig ugyanaz a natív réteg van, amit a Python implementáció is használ, így mindkét platformból kihozza a lehető legtöbbet. Ebben a részben a <a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-d2d1ee97c9db" data-href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-d2d1ee97c9db" class="markup--anchor markup--p-anchor" target="_blank">cikksorozat első részében</a> megismert konvolúciós hálót fogjuk JavaScript-re portolni, majd böngészőben futtatva betanítani és használni. A <a href="https://github.com/TheBojda/tensorflow-js-cifar10-cnn-example" data-href="https://github.com/TheBojda/tensorflow-js-cifar10-cnn-example" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">kódok természetesen elérhetőek GitHub-on</a>, sőt, mivel JavaScriptről van szó, <a href="https://thebojda.github.io/tensorflow-js-cifar10-cnn-example/" data-href="https://thebojda.github.io/tensorflow-js-cifar10-cnn-example/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">innen bárki futtathatja is őket</a> a böngészőjében.</p><figure name="bb3b" id="bb3b" class="graf graf--figure graf--iframe graf-after--p"></figure><p name="a463" id="a463" class="graf graf--p graf-after--figure">Elsőként vessünk egy pillantást a HTML fájlra. A jsDelivr CDN szerverről behúzzuk a TensorFlow.js valamint a tfjs-vis programkönyvtárakat. Az utóbbi egy hasznos vizualizációs tool TensorFlow-hoz amivel logolhatjuk a történéseket és mindenféle szép grafikonokat rajzolhatunk a tanításról. Ezek azok a dolgok amiket Python esetén a matplotlibbel rajzolgattunk. A következő két sor behúzza a data.js-t, ami a CIFAR-10-es adatokat tölti be és teszi elérhetővé tenzorok formájában (lásd <a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-d2d1ee97c9db" data-href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-d2d1ee97c9db" class="markup--anchor markup--p-anchor" target="_blank">első rész</a>), valamint a script_train.js-t, ami a tényleges kódot tartalmazza.</p><figure name="b69c" id="b69c" class="graf graf--figure graf--iframe graf-after--p"></figure><p name="097e" id="097e" class="graf graf--p graf-after--figure">A script_train.js első pár sorában behúzzuk a CIFAR-10 adathalmazt, majd a tfvis segítségével megjelenítjük az első 10 képet. A következő rész a model létrehozása. Mivel a model pöccre ugyanaz, mint az első részben, így nincs értelme róla sokat beszélni, hisz ott elmondtam már róla mindent amit kell. Ugyancsak ismerős lehet a <em class="markup--em markup--p-em">compile</em> és a <em class="markup--em markup--p-em">fit</em> metódus, amivel a tanítást végezzük. Ami egyedül újdonság, az talán csak a <em class="markup--em markup--p-em">fitCallbacks</em> rész. Ez arra szolgál, hogy a tanítás alatt minden batch feldolgozása után meghívja a rendszer a tfvis-t, ami egy grafikonra rajzolja az aktuális állapotot, így szépen nyomonkövethető a tanítás. Aki gondolja, ki is próbálhatja a fenti link segítségével. Kell hozzá egy kis türelem, mert a CIFAR-10 minták betöltése kb. fél-egy percig tart, amíg nem történik semmi. Ha ezen átküszködte magát a böngésző, utána már látjuk a grafikont meg a kék vonalat ami szépen kúszik felfelé az idő teltével. Maga a tanítás is eltart némi ideig. Géptől függően sok 10 perc is lehet mire kidobja a végén a modelt. Ha valakinek nincs kedve ezt végigvárni, az használhatja a repo-ban lévő modellt, amit már előre betanítottam. A másik lehetőség, hogy Python-ban tanítjuk be a modellt (ez sokkal gyorsabban megvan), majd átkonvertáljuk Tensorflow.js által emészthető formára. Ez utóbbihoz telepítsük a tensorflowjs_converter-t:</p><pre name="da4e" id="da4e" class="graf graf--pre graf-after--p">pip install tensorflowjs</pre><p name="225d" id="225d" class="graf graf--p graf-after--pre">Majd futtassuk le a Python-ból mentett h5 modellünkre:</p><pre name="031b" id="031b" class="graf graf--pre graf-after--p">tensorflowjs_converter — input_format keras ./my_model.h5 ./tfjs_model</pre><p name="0a8c" id="0a8c" class="graf graf--p graf-after--pre">Az eredmény egy JSON és egy bin fájl lesz a megadott könyvtárban. Előbbi a modell leírását, míg utóbbi a súlyokat tartalmazza. Ezt lehetőség szerint érdemes így csinálni. Tehát szerver oldalon, erős GPU-val (vagy akár TPU-val), Pythonban betanítani a modellt, majd konvertálni Tensorflow.js formára a böngészőben való használathoz.</p><p name="d710" id="d710" class="graf graf--p graf-after--p">Most hogy megvan a modellünk, ideje hogy használjuk. A következő egyszerű kód betölti a modellt, majd véletlenszerűen előszed egy képet a teszthalmazból és megpróbálja megmondani, hogy mi van rajta.</p><figure name="8b43" id="8b43" class="graf graf--figure graf--iframe graf-after--p"></figure><p name="fbd2" id="fbd2" class="graf graf--p graf-after--figure">A model betöltésére a <em class="markup--em markup--p-em">tf.loadLayersModel</em> szolgál, ami paraméterként a JSON fájl URL-jét várja. A következő pár sor a kirajzolja a véletlenszerűen előkapott képet, majd a jól megszokott <em class="markup--em markup--p-em">predict</em> függvénnyel futtatjuk a hálózatot. Ahogyan az első részből már tudhatjuk, a <em class="markup--em markup--p-em">predict</em> függvény egy 10 elemű vektort fog visszaadni, ami azt mutatja meg, hogy a hálózat szerint a kép melyik kategóriába mennyire tartozik bele. Azt, ahol ez az érték a legnagyobb, zölddel jelöljük meg. Ez a hálózat “tippje”.</p><p name="d1c5" id="d1c5" class="graf graf--p graf-after--p">Nagyon dióhéjban ennyit szerettem volna mondani a TensorFlow.js-ről. Ha valaki JavaScript fejlesztőként szeretne elkezdeni neurális hálókkal foglalkozni, annak mindenképp jó kiindulópont, de komolyabb dolgokhoz már mindenképp megéri megtanulni Pythonban fejelszteni, mert egyfelől sokkal több a lehetőség, másfelől minden példakód Pythonban érhető el. Persze egy-egy adott problémára elegendő lehet a JavaScript megvalósítás Node.js-el, illetve ha a cél neurális hálók böngészőben való futtatása, akkor nyilván a Tensorflow.js a(z egyik) megoldás.</p><p name="fb30" id="fb30" class="graf graf--p graf-after--p">Ha tetszett az írás, itt megtalálhatod az előző részeket:</p><div name="c49c" id="c49c" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-d2d1ee97c9db" data-href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-d2d1ee97c9db" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-d2d1ee97c9db"><strong class="markup--strong markup--mixtapeEmbed-strong">TensorFlow alapozó</strong><br><em class="markup--em markup--mixtapeEmbed-em">(neurális hálózatok, tenzorok és képfelismerés a gyakorlatban)</em>medium.com</a><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-d2d1ee97c9db" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="15660260b8dadb0ef12eafefd0be7499" data-thumbnail-img-id="1*T4ARzySpEQvEnr_9pc78pg.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*T4ARzySpEQvEnr_9pc78pg.jpeg);"></a></div><div name="0183" id="0183" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-2-14720a33aca" data-href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-2-14720a33aca" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-2-14720a33aca"><strong class="markup--strong markup--mixtapeEmbed-strong">Tensorflow alapozó 2.</strong><br><em class="markup--em markup--mixtapeEmbed-em">(backpropagation, avagy hogyan működik a varázslat)</em>medium.com</a><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-2-14720a33aca" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="acf8cadc94685ee340590198b4aca40e" data-thumbnail-img-id="1*YTDwPXrnfbPndXxNw77O-w.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*YTDwPXrnfbPndXxNw77O-w.png);"></a></div><div name="e1af" id="e1af" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-3-ac3d26071b27" data-href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-3-ac3d26071b27" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-3-ac3d26071b27"><strong class="markup--strong markup--mixtapeEmbed-strong">Tensorflow alapozó 3.</strong><br><em class="markup--em markup--mixtapeEmbed-em">(autoencoderek, word2vec és embedding avagy dimenzió redukció neurális hálókkal)</em>medium.com</a><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-3-ac3d26071b27" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="073a0d7e739a04910bab567864201655" data-thumbnail-img-id="1*JOkfva-B2_D3vJV3AYPOCQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*JOkfva-B2_D3vJV3AYPOCQ.png);"></a></div><div name="3d8a" id="3d8a" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-4-cfeee8b9e34c" data-href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-4-cfeee8b9e34c" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-4-cfeee8b9e34c"><strong class="markup--strong markup--mixtapeEmbed-strong">Tensorflow alapozó 4.</strong><br><em class="markup--em markup--mixtapeEmbed-em">(Reinforcement learning, Deep Q-learning és OpenAI Gym)</em>medium.com</a><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-4-cfeee8b9e34c" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="fcc3c58bb1fa6621af2b7b98eac4efa8" data-thumbnail-img-id="1*fBRNFgr42ZsRwFEke0zoUA.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*fBRNFgr42ZsRwFEke0zoUA.jpeg);"></a></div><div name="fd64" id="fd64" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-5-df99bc48e306" data-href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-5-df99bc48e306" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-5-df99bc48e306"><strong class="markup--strong markup--mixtapeEmbed-strong">Tensorflow alapozó 5.</strong><br><em class="markup--em markup--mixtapeEmbed-em">Visszacsatolt hálózatok és LSTM</em>medium.com</a><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-5-df99bc48e306" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="af1095d9c81da080648a19e670d10652" data-thumbnail-img-id="1*IMalbwl6uj3nlqxixZYFvA.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*IMalbwl6uj3nlqxixZYFvA.jpeg);"></a></div><div name="ecca" id="ecca" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-6-1ba1a32a79d5" data-href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-6-1ba1a32a79d5" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-6-1ba1a32a79d5"><strong class="markup--strong markup--mixtapeEmbed-strong">Tensorflow alapozó 6.</strong><br><em class="markup--em markup--mixtapeEmbed-em">GAN-ok, avagy hogyan generáljunk cicákat neurális hálóval</em>medium.com</a><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-6-1ba1a32a79d5" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="1dc770cd0ae3ee59870ee61ffe8a5b46" data-thumbnail-img-id="1*LqPaOCYKuzRjMis_sKWYwQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*LqPaOCYKuzRjMis_sKWYwQ.png);"></a></div><p name="9133" id="9133" class="graf graf--p graf-after--mixtapeEmbed">A következő rész pedig itt érhető el:</p><div name="b44c" id="b44c" class="graf graf--mixtapeEmbed graf-after--p graf--trailing"><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-8-909a84f7a961" data-href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-8-909a84f7a961" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-8-909a84f7a961"><strong class="markup--strong markup--mixtapeEmbed-strong">Tensorflow alapozó 8.</strong><br><em class="markup--em markup--mixtapeEmbed-em">avagy modellek futtatása mobilon, IoT eszközökön és akár mikrokontrollereken</em>medium.com</a><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-8-909a84f7a961" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="4ba3926425f5cdb7ae9c9eb8c2d0caf3" data-thumbnail-img-id="1*Ry0sAkDB6QJEH3KS-KN5dQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*Ry0sAkDB6QJEH3KS-KN5dQ.png);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@thebojda" class="p-author h-card">Laszlo Fazekas</a> on <a href="https://medium.com/p/57eb9a077adc"><time class="dt-published" datetime="2020-01-31T13:56:22.754Z">January 31, 2020</time></a>.</p><p><a href="https://medium.com/@thebojda/tensorflow-alapoz%C3%B3-7-57eb9a077adc" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on February 23, 2020.</p></footer></article></body></html>
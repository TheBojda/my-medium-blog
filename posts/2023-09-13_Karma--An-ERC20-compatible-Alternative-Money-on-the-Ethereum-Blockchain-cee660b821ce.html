<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Karma: An ERC20-compatible Alternative Money on the Ethereum Blockchain</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Karma: An ERC20-compatible Alternative Money on the Ethereum Blockchain</h1>
</header>
<section data-field="subtitle" class="p-summary">
Have you ever thought about how money is created? Well, typically it is made out of nothing by banks
</section>
<section data-field="body" class="e-content">
<section name="a2b0" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="afc4" id="afc4" class="graf graf--h3 graf--leading graf--title">Karma: An ERC20-compatible Alternative Money on the Ethereum Blockchain</h3><figure name="9dcc" id="9dcc" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*x6Scst8wQHqjMtDrd1tP3g.jpeg" data-width="1024" data-height="1024" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*x6Scst8wQHqjMtDrd1tP3g.jpeg"><figcaption class="imageCaption">Karma is an ERC20-compatible alternative money on the Ethereum Blockchain</figcaption></figure><p name="4fc4" id="4fc4" class="graf graf--p graf-after--figure">Have you ever thought about how money is created? Well, typically, it is made out of nothing by banks. When someone takes out a loan, the bank adds the borrowed money to the amount already recorded in its database for the bank account. So if $100 was already present in the database entry for the bank account and someone takes out a loan of $10,000, the bank will rewrite the entry&#39;s content to $10,100. Thus, the bank loans out money it does not have. Of course, the loan must be repaid.</p><p name="1584" id="1584" class="graf graf--p graf-after--p">When the loan is repaid, the money created by the loan disappears. So this money comes out of nothing and disappears into nothing (let’s not get into the subject of interest, which complicates matters a bit). This money thus only exists temporarily. There is a parable about the point of money that exists only temporarily.</p><p name="d77d" id="d77d" class="graf graf--p graf-after--p">A cowboy walks into the bar. After a few drinks, the barkeep asks him if he would lend him $10 to fix a hole in the roof. The cowboy agrees to lend the $10, with the condition that it would be paid back in a week. The barkeep calls a roofer, who fixes the roof, and the barkeep pays the $10. Meanwhile, the roofer’s shoe falls apart, and he goes to the cobbler to buy a new one for another $10. The cobbler is delighted by his unexpected windfall and quickly has the money spent in the same bar. The $10 thus returns to the barkeep.</p><p name="e4a6" id="e4a6" class="graf graf--p graf-after--p">When a week passes, the cowboy returns, and the barkeep returns the $10. The cowboy thanks him, pulls out a match, and burns the money. The barkeep, eyes wide, asks, ‘Why did you do that?’, to which the cowboy replies, ‘It’s fake money; it’s worth nothing.’</p><p name="dfa9" id="dfa9" class="graf graf--p graf-after--p">In the parable, the cowboy is like a bank. He lends money he doesn’t have. He creates this money out of thin air, and it disappears like bank loans when it is burned. Nevertheless, the bar got a new roof from this temporary money, the roofer received a new pair of shoes, and the cobbler had enough money to down a few drinks. These are tangible results of money that exists only temporarily. So what we use as money is nothing more than somebody’s debt. <strong class="markup--strong markup--p-strong">Money is debt!</strong></p><p name="0bb8" id="0bb8" class="graf graf--p graf-after--p">The value of money is ultimately based on a form of trust. We trust that others value it as well, so when we do something for someone in exchange, we accept money because we trust that it will be accepted when we require something in return. This trust makes money a universal medium of exchange.</p><p name="bdee" id="bdee" class="graf graf--p graf-after--p">A good example of this is Bitcoin. Our Bitcoin balance is nothing more than an entry in a distributed ledger. There is nothing to back it up, yet people around the world are willing to pay real money for Bitcoin. The value of Bitcoin is thus purely a matter of trust. <strong class="markup--strong markup--p-strong">Money is trust!</strong></p><p name="2ce1" id="2ce1" class="graf graf--p graf-after--p">These were the basic ideas that inspired the concept of <a href="https://medium.com/geekculture/karma-as-a-universal-cryptocurrency-ced01d29df42" data-href="https://medium.com/geekculture/karma-as-a-universal-cryptocurrency-ced01d29df42" class="markup--anchor markup--p-anchor" target="_blank">karma money</a>. What if everyone operated like a bank? Instead of taking money on credit, they would create it themselves. Of course, such a system would only work if there was a limit to the amount of money that could be created. So everyone’s debt would be public.</p><p name="5046" id="5046" class="graf graf--p graf-after--p">If I had to choose who to sell my products or services to, I would give it to the one with the least debt, as this gives the best chance of it being paid back quickly. Therefore, everyone is interested in keeping their debt low by repaying it.</p><p name="c1ef" id="c1ef" class="graf graf--p graf-after--p">Let’s look at how a cowboy parable would look in this system. There is no need for a cowboy (bank), as the barkeeper can create the $10 for the roofer himself. This creates a $10 debt for the barkeeper visible to everyone, but in return, his roof is fixed. The roofer passes this $10 on to the cobbler, and when the cobbler passes it back to the barkeeper, the $10 is destroyed along with the barkeeper’s debt. Thus, the barkeeper’s debt is again zero.</p><p name="b829" id="b829" class="graf graf--p graf-after--p">Thus, the process of creating transient money works well even without banks. All that is needed is for the roofer to trust the money created by the barkeeper and to believe that it is equally good money as the $10 created by the bank.</p><p name="7b68" id="7b68" class="graf graf--p graf-after--p">I have realized this karma money on the Ethereum Blockchain with a simple Solidity smart contract. My karma implementation is an <a href="https://ethereum.org/en/developers/docs/standards/tokens/erc-20/" data-href="https://ethereum.org/en/developers/docs/standards/tokens/erc-20/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">ERC20</a> contract, which is great because it can easily be used with any Ethereum wallet. The peculiarity of karma is that, while in the case of other currencies we spend from our balance, here, our balance starts from zero and increases with every spending (money creation). The greater our balance, the more indebted we become, so here the goal is to reduce our balance.</p><p name="97c8" id="97c8" class="graf graf--p graf-after--p">Let’s look at a brief example. Alice wants to buy apples from John, so she pays John ten karma dollars for the apples. Alice’s balance thus increases to $10. Later, John buys oranges from Alice, so when he pays $10 to Alice, the debt is settled, and Alice’s balance is reduced back to $0.</p><p name="5a55" id="5a55" class="graf graf--p graf-after--p">After the theory, let us take a look at the code (<a href="https://github.com/TheBojda/karma_money" data-href="https://github.com/TheBojda/karma_money" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">available here on GitHub</a>):</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="javascript" name="5f1d" id="5f1d" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-comment">// SPDX-License-Identifier: MIT</span><br />pragma solidity ^<span class="hljs-number">0.8</span><span class="hljs-number">.19</span>;<br /><br /><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol&quot;</span>;<br /><br />contract <span class="hljs-title class_">Karma</span> is <span class="hljs-title class_">IERC20</span>, <span class="hljs-title class_">IERC20Metadata</span> {<br />    <span class="hljs-title function_">mapping</span>(<span class="hljs-function"><span class="hljs-params">address</span> =&gt;</span> uint256) private _balances;<br />    <span class="hljs-title function_">mapping</span>(<span class="hljs-function"><span class="hljs-params">address</span> =&gt;</span> <span class="hljs-title function_">mapping</span>(<span class="hljs-function"><span class="hljs-params">address</span> =&gt;</span> uint256)) private _debts;<br />    <span class="hljs-title function_">mapping</span>(<span class="hljs-function"><span class="hljs-params">address</span> =&gt;</span> <span class="hljs-title function_">mapping</span>(<span class="hljs-function"><span class="hljs-params">address</span> =&gt;</span> uint256)) private _allowances;<br /><br />    string private _name;<br />    string private _symbol;<br />    uint private _cycleReward;<br /><br />    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">string memory name_, string memory symbol_, uint cycleReward</span>) {<br />        _name = name_;<br />        _symbol = symbol_;<br />        _cycleReward = cycleReward;<br />    }<br /><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">name</span>(<span class="hljs-params"></span>) public view virtual override returns (string memory) {<br />        <span class="hljs-keyword">return</span> _name;<br />    }<br /><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">symbol</span>(<span class="hljs-params"></span>) public view virtual override returns (string memory) {<br />        <span class="hljs-keyword">return</span> _symbol;<br />    }<br /><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">decimals</span>(<span class="hljs-params"></span>) public view virtual override returns (uint8) {<br />        <span class="hljs-keyword">return</span> <span class="hljs-number">18</span>;<br />    }<br /><br />    <span class="hljs-comment">// totalSupply is meaningless</span><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">totalSupply</span>(<span class="hljs-params"></span>) public view virtual override returns (uint256) {<br />        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br />    }<br /><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">balanceOf</span>(<span class="hljs-params"><br />        address account<br />    </span>) public view virtual override returns (uint256) {<br />        <span class="hljs-keyword">return</span> _balances[account];<br />    }<br /><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">debtOf</span>(<span class="hljs-params"><br />        address debtor,<br />        address creditor<br />    </span>) public view virtual returns (uint256) {<br />        <span class="hljs-keyword">return</span> _debts[debtor][creditor];<br />    }<br /><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">transfer</span>(<span class="hljs-params"><br />        address to,<br />        uint256 amount<br />    </span>) public virtual override returns (bool) {<br />        <span class="hljs-title function_">_transfer</span>(msg.<span class="hljs-property">sender</span>, to, amount);<br />        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br />    }<br /><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">allowance</span>(<span class="hljs-params"><br />        address owner,<br />        address spender<br />    </span>) public view virtual override returns (uint256) {<br />        <span class="hljs-keyword">return</span> _allowances[owner][spender];<br />    }<br /><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">approve</span>(<span class="hljs-params"><br />        address spender,<br />        uint256 amount<br />    </span>) public virtual override returns (bool) {<br />        <span class="hljs-built_in">require</span>(spender != <span class="hljs-title function_">address</span>(<span class="hljs-number">0</span>), <span class="hljs-string">&quot;ERC20: approve to the zero address&quot;</span>);<br /><br />        address owner = msg.<span class="hljs-property">sender</span>;<br />        _allowances[owner][spender] = amount;<br />        emit <span class="hljs-title class_">Approval</span>(owner, spender, amount);<br />        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br />    }<br /><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">transferFrom</span>(<span class="hljs-params"><br />        address <span class="hljs-keyword">from</span>,<br />        address to,<br />        uint256 amount<br />    </span>) public virtual override returns (bool) {<br />        <span class="hljs-title function_">_spendAllowance</span>(<span class="hljs-keyword">from</span>, msg.<span class="hljs-property">sender</span>, amount);<br />        <span class="hljs-title function_">_transfer</span>(<span class="hljs-keyword">from</span>, to, amount);<br />        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br />    }<br /><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">mineCycle</span>(<span class="hljs-params"><br />        address[] memory nodes,<br />        uint256 amount<br />    </span>) public virtual returns (bool) {<br />        <span class="hljs-comment">// checking debts in cycle from 0..n</span><br />        <span class="hljs-keyword">for</span> (uint i = <span class="hljs-number">0</span>; i &lt; nodes.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i++) {<br />            <span class="hljs-built_in">require</span>(<br />                _debts[nodes[i]][nodes[i + <span class="hljs-number">1</span>]] &gt;= amount,<br />                <span class="hljs-string">&quot;Karma: Not enough debt for the cycle&quot;</span><br />            );<br />        }<br /><br />        <span class="hljs-comment">// checking the last debt (end of cycle)</span><br />        <span class="hljs-built_in">require</span>(<br />            _debts[nodes[nodes.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]][nodes[<span class="hljs-number">0</span>]] &gt;= amount,<br />            <span class="hljs-string">&quot;Karma: Not enough debt for the cycle&quot;</span><br />        );<br /><br />        <span class="hljs-comment">// decreasing the debts and balances and pay cyleReward</span><br />        <span class="hljs-keyword">for</span> (uint i = <span class="hljs-number">0</span>; i &lt; nodes.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i++) {<br />            _debts[nodes[i]][nodes[i + <span class="hljs-number">1</span>]] -= amount;<br />            _balances[nodes[i]] -= amount;<br />            <span class="hljs-title function_">_transfer</span>(nodes[i], msg.<span class="hljs-property">sender</span>, _cycleReward);<br />        }<br /><br />        _debts[nodes[nodes.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]][nodes[<span class="hljs-number">0</span>]] -= amount;<br />        _balances[nodes[nodes.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]] -= amount;<br />        <span class="hljs-title function_">_transfer</span>(nodes[nodes.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>], msg.<span class="hljs-property">sender</span>, _cycleReward);<br /><br />        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br />    }<br /><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">_transfer</span>(<span class="hljs-params"><br />        address <span class="hljs-keyword">from</span>,<br />        address to,<br />        uint256 amount<br />    </span>) internal virtual {<br />        <span class="hljs-built_in">require</span>(to != <span class="hljs-title function_">address</span>(<span class="hljs-number">0</span>), <span class="hljs-string">&quot;ERC20: transfer to the zero address&quot;</span>);<br /><br />        _balances[<span class="hljs-keyword">from</span>] += amount;<br />        _debts[<span class="hljs-keyword">from</span>][to] += amount;<br /><br />        emit <span class="hljs-title class_">Transfer</span>(<span class="hljs-keyword">from</span>, to, amount);<br />    }<br /><br />    <span class="hljs-keyword">function</span> <span class="hljs-title function_">_spendAllowance</span>(<span class="hljs-params"><br />        address owner,<br />        address spender,<br />        uint256 amount<br />    </span>) internal virtual {<br />        uint256 currentAllowance = <span class="hljs-title function_">allowance</span>(owner, spender);<br />        <span class="hljs-keyword">if</span> (currentAllowance != <span class="hljs-title function_">type</span>(uint256).<span class="hljs-property">max</span>) {<br />            <span class="hljs-built_in">require</span>(<br />                currentAllowance &gt;= amount,<br />                <span class="hljs-string">&quot;ERC20: insufficient allowance&quot;</span><br />            );<br /><br />            uint256 newAmount = currentAllowance - amount;<br />            _allowances[owner][spender] = newAmount;<br />            emit <span class="hljs-title class_">Approval</span>(owner, spender, newAmount);<br />        }<br />    }<br />}</span></pre><p name="5ca6" id="5ca6" class="graf graf--p graf-after--pre">As can be seen, this is a completely standard ERC20 token. In the constructor, we can specify the token name and symbol and a parameter called <code class="markup--code markup--p-code">cycleReward</code>, which we will discuss later. Karma can represent dollars, euros, any money, but also time (e.g., I will work for you for one hour in exchange for one hour of work) or anything else. So karma is a general lending system.</p><p name="bddf" id="bddf" class="graf graf--p graf-after--p">The ERC20 standard’s <code class="markup--code markup--p-code">balanceOf</code> method is for querying any individual’s balance. It is important that each person is only linked to one Ethereum address. If that were not the case, then if someone got very indebted, they would simply open a new account, thus the whole system would be pointless. Fortunately, there are solutions such as <a href="https://proofofhumanity.id/" data-href="https://proofofhumanity.id/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Proof of Humanity</a> or <a href="https://worldcoin.org/" data-href="https://worldcoin.org/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">WorldCoin</a>, which can ensure that each individual has a unique address.</p><p name="83a4" id="83a4" class="graf graf--p graf-after--p">I also introduced a <code class="markup--code markup--p-code">debtOf</code> function, which can precisely query who owes how many points to whom.</p><p name="ee8a" id="ee8a" class="graf graf--p graf-after--p">The standard <code class="markup--code markup--p-code">transfer</code> function is used for moving the balance. On the one hand, this increases the user’s balance; on the other, it records the debt to the receiving party. Therefore, if Alice pays John $10, Alice’s balance will be increased by $10, and it will be noted that Alice owes John $10.</p><p name="52d9" id="52d9" class="graf graf--p graf-after--p">It may appear that the code isn’t exactly doing what I described earlier. For instance, if John now pays Alice $10, instead of Alice and John having a balance of $0, Alice’s balance will stay at $10, and John’s balance will also become $10. In addition, in the debt matrix, Alice will now owe John $10, and John will owe Alice $10. Why doesn’t the smart contract resolve these debts?</p><p name="6a26" id="6a26" class="graf graf--p graf-after--p">Alice and John’s case is very straightforward, but typically, much more complicated debt chains form. In the cowboy example, there were three people along the chain. However, it is conceivable for a chain to contain ten or more people. Finding such chains is by no means trivial. This is why karma miners are needed.</p><p name="80f0" id="80f0" class="graf graf--p graf-after--p">The karma miners constantly watch the debt graph; if they discover a cycle, they can submit it to the smart contract. This is what the <code class="markup--code markup--p-code">mineCycle</code> method is for. The method checks the submitted chain; if it is valid, it will execute the modifications to balances. For this, the miner will receive a small karma from each member of the chain for reducing their balances (the amount of reward is defined by the <code class="markup--code markup--p-code">cycleReward</code>).</p><p name="8a4e" id="8a4e" class="graf graf--p graf-after--p">Thus, karma mining is almost exactly the same as mining Bitcoin. The member runs a program on their machine, consuming electricity and computation power (finding cycles in a graph), producing karma in return.</p><p name="545c" id="545c" class="graf graf--p graf-after--p">There are still a few ERC20 standard-related methods, but these are not of interest from a system standpoint.</p><p name="efc4" id="efc4" class="graf graf--p graf-after--p">Karma can be an ideal solution for communities seeking an alternative to the traditional money system. But members of such a system can also be companies or projects. For example, an open source project can accept donations and pay developers in karma, who can then exchange this for, say, locally grown vegetables and fruits in a community using karma.</p><p name="38fe" id="38fe" class="graf graf--p graf-after--p graf--trailing">Of course, there is no legal framework backing up karma like there is for actual money, but Bitcoin has shown that a currency can work purely on trust — without any backing. Compared to Bitcoin, karma does not require huge computing power, nor does it have a country’s energy consumption. The system relies on trust, and our identity backs the money.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@thebojda" class="p-author h-card">Laszlo Fazekas</a> on <a href="https://medium.com/p/cee660b821ce"><time class="dt-published" datetime="2023-09-13T15:58:58.437Z">September 13, 2023</time></a>.</p><p><a href="https://medium.com/@thebojda/karma-an-erc20-compatible-alternative-money-on-the-ethereum-blockchain-cee660b821ce" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 16, 2023.</p></footer></article></body></html>
<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>DAppok és event-ek az okosszerződésekben (avagy kapcsolat a külvilággal) #ethereumtudas</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">DAppok és event-ek az okosszerződésekben (avagy kapcsolat a külvilággal) #ethereumtudas</h1>
</header>
<section data-field="subtitle" class="p-summary">
Az előző részben kicsit belemásztunk az embark által generált okosszerződés kódjába. Ebben a részben vetünk egy pillantást a kód másik…
</section>
<section data-field="body" class="e-content">
<section name="f81a" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="406f" id="406f" class="graf graf--h3 graf--leading graf--title"><strong class="markup--strong markup--h3-strong">DAppok és event-ek az okosszerződésekben (avagy kapcsolat a külvilággal) #ethereumtudas</strong></h3><p name="99aa" id="99aa" class="graf graf--p graf-after--h3">Az előző részben kicsit belemásztunk az embark által generált okosszerződés kódjába. Ebben a részben vetünk egy pillantást a kód másik felére, ami a felhasználói felület vezérléséért felelős, aztán picit bele is nyúlunk mindkét részbe és megismerkedünk az eseményekkel (eventekkel). Az események önmagukban is érdekes dolgok (olyanokról fogunk szót ejteni, mint önmagukat bérbe adni képes autók és lakások), de ismeretük nagyon fontos például szabványos (ERC20-as) tokenek létrehozásához.</p><figure name="6692" id="6692" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*QbfFqGz52EeXvoCEGNYA7w.jpeg" data-width="1280" data-height="851" src="https://cdn-images-1.medium.com/max/800/1*QbfFqGz52EeXvoCEGNYA7w.jpeg"></figure><p name="9232" id="9232" class="graf graf--p graf-after--figure">Csapjunk is bele a közepébe. Az előző részben említettük, hogy az Ethereumot egyfajta új webnek (web3) tekinthetjük. Ezen az elosztott hálózaton futnak a DApp-ok (decentralizált alkalmazások), ahol a backendet az okosszerződések képezik, amik fölé húzhatunk egy felhasználóbarát frontendet. Az embark által generált demo projektben ez a frontend az a weboldal, amin gombok segítségével beállíthatjuk, illetve lekérdezhetjük a tárolt változó értékét. Vessünk egy pillantást az embark által generált JavaScript kód (embark_demo/app/js/index.js) kód elejére.</p><figure name="3896" id="3896" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/TheBojda/63493d9ec6f174ce746ab68db9068bc4.js"></script></figure><blockquote name="57c7" id="57c7" class="graf graf--blockquote graf-after--figure">Gabriel: A backend az ami mondjuk egy weboldal nem látható részében történik (egy online bank esetében ezek adatbázisok és egyéb pl. biztonsági részek halmaza és az ezeket lekezelő programok). A frontent pedig az amit látunk pl. egy weboldal, blog, webshop, stb.</blockquote><p name="7068" id="7068" class="graf graf--p graf-after--blockquote">Aki járatos a JavaScriptben, az rögtön láthatja, hogy az embark rendkívüli módon megkönnyíti a fejlesztést, hiszen létrehoz egy JavaScript osztályt az okosszerződéshez (SimpleStorage néven), amin keresztül szimpla metódus hívásokkal kommunikálhatunk a szerződéssel. Tulajdonképpen ennél egyszerűbb dolgunk már talán nem is lehetne.</p><p name="cd8d" id="cd8d" class="graf graf--p graf-after--p">Aki nem annyira járatos a JavaScript világában, az se keseredjen el, hiszen az okos szerződések programozásához nem feltétlenül van erre szükség. Azért ejtsünk erről pár szót, hogy teljes legyen a kép. Amit mindebből érdemes kiemelni, hogy az érték beállítása a SimpleStorage.set(value); sorral történik, ami automatikusan lefuttatja a szükséges tranzakciót, míg a kiolvasásért a SimpleStorage.get() kezdetű sor a felelős. Itt az eredmény aszinkron módon (nem rögtön) áll rendelkezésre (ki kell szólni az Ethereum kliensnek, ami feldolgozza a kérést, majd ha kész, akkor szól vissza). Ha megjött az eredmény, a kód beírja azt az edit mezőbe. Erről a részről többet nem is írnék. Aki járatos a HTML és a JavaScript világában, az ennyiből érti már, hogy miről van szó, a vonatkozó rész pontos elemzése viszont túlmutatna tananyagunk keretein (JavaScript, JQuery és HTML ismeretek). Még egyszer hangsúlyoznám, hogy az okosszerződések programozásához nem feltétlen szükséges JavaScript tudás. Mi ezt a későbbiekben csak az okosszerződés teszteléséhez fogjuk használni.</p><h3 name="c357" id="c357" class="graf graf--h3 graf-after--p"><strong class="markup--strong markup--h3-strong">Események (eventek)</strong></h3><p name="1d31" id="1d31" class="graf graf--p graf-after--h3">Térjünk inkább rá a cikk fő témájára, vagyis az eseményekre (eventekre). Bizonyára sokakban felmerül a kérdés, hogy szép dolog egy ilyen okos szerződés, de mégis hogyan kommunikál egy ilyen a külvilággal? Amíg információt akarunk közölni egy okos szerződéssel, addig nincs gond, hiszen csak meg kell hívnunk egy adott funkciót (jelen esetben például a set-et). No de hogy történik a másik irányba való kommunikáció, vagyis amikor az okos szerződésnek kellene a külvilág felé információt közölnie?</p><p name="2eec" id="2eec" class="graf graf--p graf-after--p">Rögtön említsünk is egy példát, hogy érthető legyen a dolog. Tegyük fel, hogy van egy lakásunk, aminek a kiadását mindenféle ügynökök helyett inkább egy okos szerződésre bíznánk. Felszerelünk a lakásra egy intelligens zárat, és kiragasztunk az ajtóra egy matricát egy Ethereum címmel. Ha valaki erre a címre elutalja a megadott összeget, a zár kinyílik, és be lehet menni a lakásba. Nos, egy ilyen rendszer elvileg simán megvalósítható Ethereumon okosszerződések segítségével. (Üdv a jövőben, ami a jelen technológiájára épül.) Az okosszerződés kb. úgy nézne ki ebben az esetben, hogy mikor pénzt utalunk neki, az ellenőrzi az összeget. Ha nem elegendő, visszautalja, ha elegendő, szól a zárnak, hogy nyíljon ki. No de hogy tud egy okos szerződés kiszólni a külvilágban található okos zárnak? Nos, erre szolgálnak az események.</p><p name="b0e3" id="b0e3" class="graf graf--p graf-after--p">Bármilyen okosszerződés definiálhat eseményeket, amiket képes kiküldeni. Ha egy funkció eseményt generál, az ugyanúgy beíródik a blokkláncba. Ezeket az eseményeket az egyes kliensek képesek figyelni és végrehajtani valamilyen funkciót, ha az előzőleg beállított szűrőfeltételeknek megfelelő esemény bekövetkezik. A megfelelő esemény (talán szerencsésebb lenne üzenetnek hívni) kinyithat egy zárat, elindíthat egy pénzügyi tranzakciót (pl. robotizált tőzsde esetén token visszavásárlás), vagy bármilyen más folyamatot. Például utasíthat egy önjáró autót, hogy a megadott címre menjen, ezzel megvalósítva akár a decentralizált Ubert. Ugyanilyen eseményeknek köszönhetően képesek érzékelni az egyes digitális pénztárcák, hogy valamilyen token érkezett a tárcába. Ezért írtam az elején, hogy az ERC20-as token szabványban is szerepet kapnak az események.</p><blockquote name="b581" id="b581" class="graf graf--blockquote graf-after--p">Gabriel: A lakás bérbeadása és a digitális pénztárcák nagyon jó példák arra, hogy megértsük az eventek lényegét és az ERC20-as token szabványt. Nagyon sokan kérdezik, hogy pl. tokent miért nem lehet Coinbase, Bittrex vagy egyéb cryptovaluta kereskedő rendszerekkel vásárolni. Nos azért, mivel ezek nem támogatják ERC20-at (joggal, mert más célt szolgálnak).</blockquote><p name="b6bb" id="b6bb" class="graf graf--p graf-after--blockquote">Az elmélet után térjünk át a gyakorlatra: Egy eseményt az <strong class="markup--strong markup--p-strong">event</strong> kulcsszóval definiálhatunk. Meg kell adnunk az esemény nevét és paramétereit, amelyek az esemény által hordozott adatok. Hozzunk is létre egy teszt eseményt, ami az eseményt kiváltó személy Ethereum címét és egy pozitív egész számot tartalmazhat. Ez így néz ki:</p><blockquote name="a4de" id="a4de" class="graf graf--blockquote graf-after--p">event TestEvent(address from, uint value);</blockquote><p name="edd9" id="edd9" class="graf graf--p graf-after--blockquote">Kössük is be a meglévő smart contractunkba, ami a módosítások után így fog kinézni:</p><figure name="332c" id="332c" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/TheBojda/6a1b50e87c189427a26f8741d689b10d.js"></script></figure><p name="a712" id="a712" class="graf graf--p graf-after--figure">Az esemény meghívása a set metódusban történik, tehát akkor fog kiváltódni, ha beállítunk egy értéket. Ez esetben az esemény cím paraméterébe az msg.sender értéke kerül, ami a metódust hívó felhasználó Ethereum címe, míg az érték paraméterbe a set-nek küldött érték. Tehát ezek után ha valamilyen értéket beálltunk a smart contract-ban, az generálni fog egy ilyen TestEvent eseményt. Hogy valami értelme is legyen a dolognak, ültessünk rá egy figyelőt, ami most annyit fog csinálni, hogy feldob egy alert ablakot, amibe kiírja az eseményben érkező címet és értéket. Ez így néz ki:</p><figure name="5439" id="5439" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/TheBojda/8f1413acf95962fad5803d3bf8eaaee5.js"></script></figure><p name="e066" id="e066" class="graf graf--p graf-after--figure">Ezzel együtt a teljes javascript kód ilyen lett:</p><figure name="0cd8" id="0cd8" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/TheBojda/32ef1f9f9526bdd0896bc454b48f0f31.js"></script></figure><p name="c71b" id="c71b" class="graf graf--p graf-after--figure">Az emberknak hála elég ha átírjuk a megfelelő részeket, és elmentjük. Nem kell semmit újrafordítani, újraindítani, az embark megcsinál mindent a háttérben. Elég ha a böngészőben ráfrissítünk az oldalra, és ha minden jól megy, működni fog a dolog. Tehát ha beírunk egy számot az okosszerződésbe, fel fog ugrani egy alert ablak, ahol láthatóak az eseményben megadott információk. Igazából ennyit szántam mára.</p><blockquote name="27c3" id="27c3" class="graf graf--blockquote graf-after--p">Gabriel: Ha nem világos minden, jobb inkább elidőzni és újraolvasni az egész bejegyzést és kísérletezgetni a kóddal. A teljes megértés érdekében ajánljuk, hogy az itt leírt dolgat próbáld is azonnal ki a gépedre már előzőekben telepített tesztkörnyezetben (ha nincs még feltelepítve az Ethereum fejlesztői tesztkörnyezeted olvasd vissza az ezzel kapcsolatos többi bejegyzésünket).</blockquote><p name="4a49" id="4a49" class="graf graf--p graf-after--blockquote">Láthattuk tehát, hogy a metódusok és események segítségével az okosszerződések hogyan kommunikálhatnak a külvilággal. A közeljövőben olyan szolgáltatásokat válthatnak le ezen automatizmusok, mint amilyen az AirBnb vagy az Uber. A következő részekben meg fogjuk mutatni, hogy hogyan lehet pénzt (Ethert) fogadni és utalni okos szerződésekkel, majd készítünk saját tokeneket is, amelyek például a mostanában oly divatos ICO-k alapjai (amivel korunk kirpto-startupjai percek alatt szednek össze több millió dolláros befektetéseket). Tartsatok velünk…</p><h3 name="552e" id="552e" class="graf graf--h3 graf-after--p">Kövess minket!</h3><p name="0e27" id="0e27" class="graf graf--p graf-after--h3">A cikksorozat további részeiben ezekkel az okos szerződésekkel fogunk közelebbről megismerkedni, és megtanuljuk azt is, hogy hogyan készíthetünk ilyeneket mi magunk is.</p><p name="4df4" id="4df4" class="graf graf--p graf-after--p">Hogy mindez tényleg felfogható lehessen a cikksorozatot ketten fogjuk írni. A programozói részekért jómagam <a href="https://medium.com/u/792a8f999852" data-href="https://medium.com/u/792a8f999852" data-anchor-type="2" data-user-id="792a8f999852" data-action-value="792a8f999852" data-action="show-user-card" data-action-type="hover" class="markup--user markup--p-user" target="_blank">Laszlo Fazekas</a>(fejlesztő) felelek majd, azért pedig, hogy tényleg minden érthető legyen <a href="https://medium.com/u/f91cbcd0bc44" data-href="https://medium.com/u/f91cbcd0bc44" data-anchor-type="2" data-user-id="f91cbcd0bc44" data-action-value="f91cbcd0bc44" data-action="show-user-card" data-action-type="hover" class="markup--user markup--p-user" target="_blank">Gabriel Varaljay</a>(marketing) “játssza majd a naivat” (tesz fel kérdéseket, magyarázza újra a feldolgozott anyagot).</p><p name="3dcb" id="3dcb" class="graf graf--p graf-after--p graf--trailing">Épp ezért érdemes feliratkoznod <a href="https://medium.com/envienta-magyarország" data-href="https://medium.com/envienta-magyarország" class="markup--anchor markup--p-anchor" target="_blank">ERRE a medium csatornára</a>, de követheted az ENVIENTA Magyarországot <a href="https://twitter.com/envientahun" data-href="https://twitter.com/envientahun" class="markup--anchor markup--p-anchor" rel="nofollow noopener nofollow noopener noopener" target="_blank">Twitteren</a>, vagy akár csatlakozhatsz a <a href="https://www.facebook.com/groups/1459500857429638/" data-href="https://www.facebook.com/groups/1459500857429638/" class="markup--anchor markup--p-anchor" rel="nofollow noopener nofollow noopener noopener" target="_blank">tematikus Facebook csoportunkhoz</a> is.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@thebojda" class="p-author h-card">Laszlo Fazekas</a> on <a href="https://medium.com/p/37fca04681d"><time class="dt-published" datetime="2017-08-21T13:07:02.687Z">August 21, 2017</time></a>.</p><p><a href="https://medium.com/@thebojda/dappok-%C3%A9s-event-ek-az-okosszerz%C5%91d%C3%A9sekben-avagy-kapcsolat-a-k%C3%BClvil%C3%A1ggal-ethereumtudas-37fca04681d" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on March 9, 2021.</p></footer></article></body></html>